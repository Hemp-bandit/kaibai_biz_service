name: CI
on:
  push:
    branches:
      - dev
  # pull_request:
  #   branches: ['master']
  #   types: [closed]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: pull repo
        shell: bash
        run: |
          echo "git clone "
          git clone  https://github.com/Hemp-bandit/kaibai_biz_service .
          ls -al
      - name: build_img
        run: bash build.sh build_img
      - name: Docker Login
        uses: docker/login-action@v3.3.0
        with:
          registry: registry.cn-hangzhou.aliyuncs.com
          username: ${{ secrets.ALI_IMG_HUB_USER }}
          password: ${{ secrets.ALI_IMG_HUB_PASS }}
      - name: push_img
        run: bash build.sh push_img
